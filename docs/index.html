<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Principal Component Analysis for bigmemory Matrices • bigPCAcpp</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Principal Component Analysis for bigmemory Matrices">
<meta name="description" content="High performance principal component analysis routines that operate directly on bigmemory::big.matrix objects. The package avoids materialising large matrices in memory by streaming data through BLAS and LAPACK kernels and provides helpers to derive scores, loadings, correlations, and contribution diagnostics, including utilities that stream results into bigmemory-backed matrices for file-based workflows. Additional interfaces expose scalable singular value decomposition, robust PCA, and robust SVD algorithms so that users can explore large matrices while tempering the influence of outliers. Scalable principal component analysis &lt;doi:10.1145/2723372.2751520&gt; is also implemented.">
<meta property="og:description" content="High performance principal component analysis routines that operate directly on bigmemory::big.matrix objects. The package avoids materialising large matrices in memory by streaming data through BLAS and LAPACK kernels and provides helpers to derive scores, loadings, correlations, and contribution diagnostics, including utilities that stream results into bigmemory-backed matrices for file-based workflows. Additional interfaces expose scalable singular value decomposition, robust PCA, and robust SVD algorithms so that users can explore large matrices while tempering the influence of outliers. Scalable principal component analysis &lt;doi:10.1145/2723372.2751520&gt; is also implemented.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">bigPCAcpp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/bigPCAcpp.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/bigPCA-benchmarks.html">Benchmarking bigPCAcpp Workflows</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fbertran/bigPCAcpp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="bigpcacpp-">bigPCAcpp <img src="reference/figures/BigPCAcpp_hex_dark.svg" align="right" width="200"><a class="anchor" aria-label="anchor" href="#bigpcacpp-"></a>
</h1></div>
</div>
<div class="section level1">
<h1 id="principal-component-analysis-for-bigmemory-matrices">Principal component analysis for bigmemory matrices<a class="anchor" aria-label="anchor" href="#principal-component-analysis-for-bigmemory-matrices"></a>
</h1>
<div class="section level2">
<h2 id="frédéric-bertrand">Frédéric Bertrand<a class="anchor" aria-label="anchor" href="#fr%C3%A9d%C3%A9ric-bertrand"></a>
</h2>
<!-- badges: start -->

<p>The <strong>bigPCAcpp</strong> package provides high performance principal component analysis (PCA) routines specialised for <code><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">bigmemory::big.matrix</a></code> objects. It keeps data in bigmemory allocations from ingestion through eigendecomposition so that very large matrices can be analysed without copying them into base R matrices. In addition to the PCA core, the package offers streaming helpers that write scores, loadings, correlations, and contributions back into file-backed <code>big.matrix</code> targets for integration with downstream pipelines.</p>
<p>Beyond classical PCA, the package ships with scalable SVD tools that can process file-backed matrices block by block, and it includes robust PCA and robust SVD routines that temper the influence of outliers while remaining compatible with bigmemory workflows. For exploratory work on large batches, a scalable PCA interface lets users extract leading components without reading the full matrix into memory.</p>
<p>These workflows make it possible to analyse data sets that exceed the available RAM while keeping numerical stability through double-precision accumulation and LAPACK eigen decompositions. Current features include</p>
<ul>
<li>centring and scaling directly on <code>big.matrix</code> inputs,</li>
<li>incremental score generation that avoids bringing data into memory,</li>
<li>helpers to persist PCA diagnostics in file-backed storage,</li>
<li>SVD utilities for dense and robust decompositions backed by <code>bigmemory</code>, and</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <strong>bigPCAcpp</strong> from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"fbertran/bigPCAcpp"</span><span class="op">)</span></span></code></pre></div>
<p>If you prefer a local source install, clone the repository and run:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>R CMD build bigPCAcpp</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>R CMD INSTALL bigPCAcpp_0.<span class="dv">9</span>.<span class="fl">0.</span>tar.gz</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="options">Options<a class="anchor" aria-label="anchor" href="#options"></a>
</h2>
<p>The package defines several options to control numerical tolerances and workspace allocation. They are prefixed with <code>bigPCAcpp.</code> and include:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr>
<th>Option</th>
<th>Default value</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td><code>bigPCAcpp.block_size</code></td>
<td><code>1000L</code></td>
<td>Number of rows processed in each block when streaming scores through BLAS.</td>
</tr>
<tr>
<td><code>bigPCAcpp.center_scale_epsilon</code></td>
<td><code>1e-8</code></td>
<td>Lower bound applied when rescaling columns to avoid division instabilities.</td>
</tr>
<tr>
<td><code>bigPCAcpp.progress</code></td>
<td><code>FALSE</code></td>
<td>Emit progress updates when computing PCA on long-running jobs.</td>
</tr>
</tbody>
</table>
<p>All options can be changed with <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> at runtime. For example, <code>options(bigPCAcpp.block_size = 5000L)</code> increases the streaming block size.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The examples below demonstrate the bigmemory workflow and compare the results with base R’s <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp()</a></code> implementation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaneplusplus/bigmemory" class="external-link">bigmemory</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/bigPCAcpp/">bigPCAcpp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Allocate a 1,000 x 25 big.matrix with simulated values</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, type <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="va">bm</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run PCA and extract eigenvalues and rotation</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_bigmatrix.html">pca_bigmatrix</a></span><span class="op">(</span><span class="va">bm</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">eigenvalues</span></span>
<span><span class="co">#&gt;  [1] 1.2701077 1.2537526 1.2151939 1.2024274 1.1802276 1.1354639 1.1048690</span></span>
<span><span class="co">#&gt;  [8] 1.0902075 1.0630117 1.0403948 1.0224523 1.0122884 0.9931732 0.9852838</span></span>
<span><span class="co">#&gt; [15] 0.9550143 0.9414302 0.9204860 0.9008016 0.8898188 0.8773914 0.8437966</span></span>
<span><span class="co">#&gt; [22] 0.7979435 0.7821215 0.7628152 0.7595271</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">importance</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;             [,1]        [,2]        [,3]</span></span>
<span><span class="co">#&gt; [1,]  0.14398208  0.22870330  0.12242692</span></span>
<span><span class="co">#&gt; [2,] -0.07237026 -0.21951399  0.19761877</span></span>
<span><span class="co">#&gt; [3,] -0.32741500 -0.34723923 -0.02282739</span></span>
<span><span class="co">#&gt; [4,]  0.23671229  0.14764528  0.05672112</span></span>
<span><span class="co">#&gt; [5,]  0.14343191  0.03490776  0.10010376</span></span>
<span></span>
<span><span class="co"># Generate PCA scores in bigmemory storage</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span></span>
<span>  nrow <span class="op">=</span> <span class="va">n</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"double"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="fu"><a href="reference/pca_bigmatrix.html">pca_scores_bigmatrix</a></span><span class="op">(</span></span>
<span>  <span class="va">bm</span>,</span>
<span>  <span class="va">res</span><span class="op">$</span><span class="va">rotation</span>,</span>
<span>  center <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">center</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">scale</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">#&gt;             [,1]       [,2]       [,3]       [,4]        [,5]         [,6]</span></span>
<span><span class="co">#&gt; [1,]  0.65907229 -0.1974698 -3.5714713 -0.7150943  0.01412313  0.519975663</span></span>
<span><span class="co">#&gt; [2,] -0.20615917  2.6536525 -2.1246929 -0.2443652 -1.22009504  0.338157676</span></span>
<span><span class="co">#&gt; [3,]  1.97067655 -0.1459897  0.2706729 -2.5778456  1.03548532  1.343923490</span></span>
<span><span class="co">#&gt; [4,] -0.06521853 -0.3507049 -0.7159949  0.2779695  1.08616408 -1.106634062</span></span>
<span><span class="co">#&gt; [5,]  0.34681884  0.6974558 -2.4466572 -0.4696698  1.95794498 -0.008496806</span></span>
<span><span class="co">#&gt; [6,]  0.62390402 -0.9625778 -0.9364008  1.5785386  0.47807633  0.074748751</span></span>
<span></span>
<span><span class="co"># Compare sum of absolute values with prcomp()</span></span>
<span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">bm</span><span class="op">[</span><span class="op">]</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">pr</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p><code><a href="reference/pca_bigmatrix.html">pca_bigmatrix()</a></code> can also focus on a subset of leading components while streaming the results into file-backed matrices. The following snippet stores the first four principal components and keeps a running summary of their scores.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaneplusplus/bigmemory" class="external-link">bigmemory</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/bigPCAcpp/">bigPCAcpp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1500</span>, ncol <span class="op">=</span> <span class="fl">40</span>, type <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="va">bm</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1500</span> <span class="op">*</span> <span class="fl">40</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Request only the first four components</span></span>
<span><span class="va">top_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_bigmatrix.html">pca_bigmatrix</a></span><span class="op">(</span><span class="va">bm</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, ncomp <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">top_pca</span><span class="op">$</span><span class="va">sdev</span></span>
<span><span class="co">#&gt; [1] 1.141546 1.124998 1.119607 1.109924</span></span>
<span></span>
<span><span class="co"># Stream the corresponding scores into a file-backed allocation</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".bin"</span><span class="op">)</span></span>
<span><span class="va">desc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">".desc"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scores_fb</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">filebacked.big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bm</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             type <span class="op">=</span> <span class="st">"double"</span>, backingfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>, backingpath <span class="op">=</span></span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>, descriptorfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">desc</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/pca_stream_bigmatrix.html">pca_scores_stream_bigmatrix</a></span><span class="op">(</span></span>
<span>  <span class="va">bm</span>,</span>
<span>  <span class="va">scores_fb</span>,</span>
<span>  <span class="va">top_pca</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  center <span class="op">=</span> <span class="va">top_pca</span><span class="op">$</span><span class="va">center</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">top_pca</span><span class="op">$</span><span class="va">scale</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pointer: 0x1596ceca0&gt;</span></span>
<span></span>
<span><span class="co"># Inspect a lightweight summary without loading the entire matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">scores_fb</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.944992e-17 3.064216e-17</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">scores_fb</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.141546 1.124998</span></span></code></pre></div>
<p>To stream the diagnostics into <code>bigmemory</code>-backed matrices, use the corresponding helper functions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaneplusplus/bigmemory" class="external-link">bigmemory</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/bigPCAcpp/">bigPCAcpp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, type <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="va">bm</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rotation</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">loadings</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">correlations</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">contrib</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pca_stream</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_stream_bigmatrix.html">pca_stream_bigmatrix</a></span><span class="op">(</span><span class="va">bm</span>, xpRotation <span class="op">=</span> <span class="va">rotation</span>, </span>
<span>                                   center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/pca_stream_bigmatrix.html">pca_variable_loadings_stream_bigmatrix</a></span><span class="op">(</span><span class="va">rotation</span>, <span class="va">pca_stream</span><span class="op">$</span><span class="va">sdev</span>,</span>
<span>                                       <span class="va">loadings</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pointer: 0x1596df4e0&gt;</span></span>
<span><span class="fu"><a href="reference/pca_stream_bigmatrix.html">pca_variable_correlations_stream_bigmatrix</a></span><span class="op">(</span><span class="va">rotation</span>, <span class="va">pca_stream</span><span class="op">$</span><span class="va">sdev</span>,</span>
<span>                           <span class="va">pca_stream</span><span class="op">$</span><span class="va">column_sd</span>, <span class="va">correlations</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in pca_variable_correlations_stream_bigmatrix(rotation, pca_stream$sdev, : argument "xpDest" is missing, with no default</span></span>
<span><span class="fu"><a href="reference/pca_stream_bigmatrix.html">pca_variable_contributions_stream_bigmatrix</a></span><span class="op">(</span><span class="va">loadings</span>, <span class="va">contrib</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pointer: 0x159655010&gt;</span></span></code></pre></div>
<div class="section level3">
<h3 id="robust-pca-and-singular-value-decompositions">Robust PCA and singular value decompositions<a class="anchor" aria-label="anchor" href="#robust-pca-and-singular-value-decompositions"></a>
</h3>
<p>Robust workflows dampen the influence of outliers while retaining the familiar PCA interface. The <code><a href="reference/pca_robust.html">pca_robust()</a></code> helper centres variables by the median, optionally scales by the MAD, and relies on an iteratively reweighted SVD to derive principal components. The same robust solver is exposed directly via <code><a href="reference/svd_robust.html">svd_robust()</a></code> for use in custom pipelines, and the streaming-friendly <code><a href="reference/svd_bigmatrix.html">svd_bigmatrix()</a></code> wrapper computes classical SVDs on <code>big.matrix</code> objects without materialising dense copies in memory.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaneplusplus/bigmemory" class="external-link">bigmemory</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/bigPCAcpp/">bigPCAcpp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">40</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">15</span>  <span class="co"># introduce an outlier</span></span>
<span><span class="va">mat_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">mat</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Classical PCA on the same data highlights the impact of the outlier</span></span>
<span><span class="va">bm_small</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat_scaled</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat_scaled</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="va">bm_small</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mat_scaled</span></span>
<span><span class="va">classical</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_bigmatrix.html">pca_bigmatrix</a></span><span class="op">(</span><span class="va">bm_small</span>, center <span class="op">=</span> <span class="cn">FALSE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, ncomp <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">classical</span><span class="op">$</span><span class="va">explained_variance</span></span>
<span><span class="co">#&gt; [1] 0.2940708 0.2332728 0.2031007</span></span>
<span></span>
<span><span class="va">scores_classical</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_bigmatrix.html">pca_scores_bigmatrix</a></span><span class="op">(</span>xpMat <span class="op">=</span> <span class="va">bm_small</span>, rotation <span class="op">=</span> <span class="va">classical</span><span class="op">$</span><span class="va">rotation</span>, center <span class="op">=</span> <span class="va">classical</span><span class="op">$</span><span class="va">center</span>, <span class="va">classical</span><span class="op">$</span><span class="va">scale</span><span class="op">)</span></span>
<span><span class="va">scores_classical</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="co">#&gt; [1] -4.752614 -1.534966  1.578737</span></span>
<span></span>
<span><span class="fu"><a href="reference/pca_plot_contributions.html">pca_plot_contributions</a></span><span class="op">(</span><span class="fu"><a href="reference/pca_bigmatrix.html">pca_individual_contributions</a></span><span class="op">(</span><span class="va">scores_classical</span>, <span class="va">classical</span><span class="op">$</span><span class="va">sdev</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-robustsvdexample-1.png" alt="plot of chunk robustsvdexample" width="100%"><p class="caption">
plot of chunk robustsvdexample
</p>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Robust PCA keeps the outlier from dominating the rotation</span></span>
<span><span class="va">robust</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_robust.html">pca_robust</a></span><span class="op">(</span><span class="va">mat_scaled</span>, center <span class="op">=</span> <span class="cn">FALSE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, ncomp <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">robust</span><span class="op">$</span><span class="va">explained_variance</span></span>
<span><span class="co">#&gt; [1] 0.3633363 0.3509611 0.2857026</span></span>
<span></span>
<span><span class="va">robust</span><span class="op">$</span><span class="va">scores</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1.025663 1.948710 2.095546</span></span>
<span></span>
<span><span class="fu"><a href="reference/pca_plot_contributions.html">pca_plot_contributions</a></span><span class="op">(</span><span class="fu"><a href="reference/pca_bigmatrix.html">pca_individual_contributions</a></span><span class="op">(</span><span class="va">robust</span><span class="op">$</span><span class="va">scores</span>, <span class="va">robust</span><span class="op">$</span><span class="va">sdev</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-robustsvdexample-2.png" alt="plot of chunk robustsvdexample" width="100%"><p class="caption">
plot of chunk robustsvdexample
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>classical <span class="op">=</span> <span class="va">classical</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">]</span>, robust <span class="op">=</span> <span class="va">robust</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;       classical     robust</span></span>
<span><span class="co">#&gt; [1,] -0.5793644 0.01128235</span></span>
<span><span class="co">#&gt; [2,] -0.3121420 0.59547597</span></span>
<span><span class="co">#&gt; [3,] -0.5716000 0.77399456</span></span>
<span><span class="co">#&gt; [4,]  0.4071138 0.18028142</span></span>
<span><span class="co">#&gt; [5,]  0.2728298 0.11709868</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Classical SVD on a file-backed big.matrix</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".bin"</span><span class="op">)</span></span>
<span><span class="va">desc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">".desc"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">filebacked.big.matrix</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">10</span>, type <span class="op">=</span> <span class="st">"double"</span>, backingfile <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>, backingpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>, descriptorfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">desc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bm</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">svd_stream</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/svd_bigmatrix.html">svd_bigmatrix</a></span><span class="op">(</span><span class="va">bm</span>, nu <span class="op">=</span> <span class="fl">3</span>, nv <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">svd_stream</span><span class="op">$</span><span class="va">d</span></span>
<span><span class="co">#&gt;  [1] 16.66256 15.90085 15.80823 14.84659 13.99062 13.52699 13.06717 12.61343</span></span>
<span><span class="co">#&gt;  [9] 12.15871 11.63997</span></span>
<span></span>
<span><span class="co"># Direct access to the robust SVD routine</span></span>
<span><span class="va">svd_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/svd_robust.html">svd_robust</a></span><span class="op">(</span><span class="va">mat</span>, ncomp <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">svd_out</span><span class="op">$</span><span class="va">d</span></span>
<span><span class="co">#&gt; [1] 16.789433  6.178555  5.620833</span></span>
<span><span class="va">svd_out</span><span class="op">$</span><span class="va">weights</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1 1 1 1 1 1</span></span></code></pre></div>
<p>Robust decompositions down-weight the contaminated observations while the classical stream demonstrates how to fetch singular vectors without materialising the dense matrix. The robust solver also exposes per-row weights that can be reused to flag problematic observations for further inspection.</p>
</div>
<div class="section level3">
<h3 id="plotting-diagnostics">Plotting diagnostics<a class="anchor" aria-label="anchor" href="#plotting-diagnostics"></a>
</h3>
<p><code>bigPCAcpp</code> bundles plot helpers that operate on both dense matrices and <code>big.matrix</code> backends. The snippets below illustrate how to call each function using results from <code><a href="reference/pca_bigmatrix.html">pca_bigmatrix()</a></code>. For instance, the <code><a href="reference/pca_plot_scores.html">pca_plot_scores()</a></code> helper samples observations and draws a scatter plot of their scores on a chosen pair of components, which is particularly useful when you need to visually assess potential clusters without loading the full data set into memory.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaneplusplus/bigmemory" class="external-link">bigmemory</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/bigPCAcpp/">bigPCAcpp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">6</span>, type <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="va">bm</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span> <span class="op">*</span> <span class="fl">6</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_bigmatrix.html">pca_bigmatrix</a></span><span class="op">(</span><span class="va">bm</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Scree plot of explained variance</span></span>
<span><span class="fu"><a href="reference/pca_plot_scree.html">pca_plot_scree</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotexamples-1.png" alt="plot of chunk plotexamples" width="100%"><p class="caption">
plot of chunk plotexamples
</p>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Scatter plot of sampled scores on PCs 1 and 2</span></span>
<span><span class="fu"><a href="reference/pca_plot_scores.html">pca_plot_scores</a></span><span class="op">(</span></span>
<span>  <span class="va">bm</span>,</span>
<span>  <span class="va">res</span><span class="op">$</span><span class="va">rotation</span>,</span>
<span>  center <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">center</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">scale</span>,</span>
<span>  components <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span>,</span>
<span>  max_points <span class="op">=</span> <span class="fl">2000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">2024</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotexamples-2.png" alt="plot of chunk plotexamples" width="100%"><p class="caption">
plot of chunk plotexamples
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Contribution bar plot for the leading component</span></span>
<span><span class="va">loadings</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_bigmatrix.html">pca_variable_loadings</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">rotation</span>, <span class="va">res</span><span class="op">$</span><span class="va">sdev</span><span class="op">)</span></span>
<span><span class="va">contrib</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_bigmatrix.html">pca_variable_contributions</a></span><span class="op">(</span><span class="va">loadings</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/pca_plot_contributions.html">pca_plot_contributions</a></span><span class="op">(</span><span class="va">contrib</span>, component <span class="op">=</span> <span class="fl">1L</span>, top_n <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotexamples-3.png" alt="plot of chunk plotexamples" width="100%"><p class="caption">
plot of chunk plotexamples
</p>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Correlation circle for the first two components</span></span>
<span><span class="va">correlations</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_bigmatrix.html">pca_variable_correlations</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">rotation</span>, <span class="va">res</span><span class="op">$</span><span class="va">sdev</span>, </span>
<span><span class="va">res</span><span class="op">$</span><span class="va">column_sd</span>, <span class="va">res</span><span class="op">$</span><span class="va">scale</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/pca_plot_correlation_circle.html">pca_plot_correlation_circle</a></span><span class="op">(</span><span class="va">correlations</span>, components <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotexamples-4.png" alt="plot of chunk plotexamples" width="100%"><p class="caption">
plot of chunk plotexamples
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Biplot combining scores and loadings</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">scores</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pca_bigmatrix.html">pca_scores_bigmatrix</a></span><span class="op">(</span><span class="va">bm</span>, <span class="va">res</span><span class="op">$</span><span class="va">rotation</span>, center <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">center</span>, scale <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">scale</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="reference/pca_plot_biplot.html">pca_plot_biplot</a></span><span class="op">(</span><span class="va">scores</span>, <span class="va">loadings</span>, components <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plotexamples-5.png" alt="plot of chunk plotexamples" width="100%"><p class="caption">
plot of chunk plotexamples
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <strong>bigPCAcpp</strong> in academic work, please cite:</p>
<p>Bertrand F. (2025). <em>bigPCAcpp: Principal Component Analysis for bigmemory Matrices</em>.</p>
</div>
<div class="section level2">
<h2 id="maintainer">Maintainer<a class="anchor" aria-label="anchor" href="#maintainer"></a>
</h2>
<p>Maintainer: Frédéric Bertrand <a href="mailto:frederic.bertrand@lecnam.net" class="email">frederic.bertrand@lecnam.net</a></p>
<p>For questions, bug reports, or contributions, please open an issue on <a href="https://github.com/fbertran/bigPCAcpp" class="external-link">GitHub</a>.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/fbertran/bigPCAcpp/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/fbertran/bigPCAcpp/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing bigPCAcpp</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Frederic Bertrand <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/fbertran/bigPCAcpp/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/fbertran/bigPCAcpp/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/fbertran/bigPCAcpp/actions/workflows/rhub.yaml" class="external-link"><img src="https://github.com/fbertran/bigPCAcpp/actions/workflows/rhub.yaml/badge.svg" alt="R-hub"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Frederic Bertrand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

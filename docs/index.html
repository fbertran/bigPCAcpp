<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Principal Component Analysis for bigmemory Matrices • bigPCA</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Principal Component Analysis for bigmemory Matrices">
<meta name="description" content="High performance principal component analysis routines that operate directly on bigmemory::big.matrix objects. The package avoids materialising large matrices in memory by streaming data through BLAS and LAPACK kernels and provides helpers to derive scores, loadings, correlations, and contribution diagnostics, including utilities that write results into bigalgebra-backed matrices for file-based workflows.">
<meta property="og:description" content="High performance principal component analysis routines that operate directly on bigmemory::big.matrix objects. The package avoids materialising large matrices in memory by streaming data through BLAS and LAPACK kernels and provides helpers to derive scores, loadings, correlations, and contribution diagnostics, including utilities that write results into bigalgebra-backed matrices for file-based workflows.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">bigPCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/bigPCA.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fbertran/bigPCAcpp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="bigpca">bigPCA<a class="anchor" aria-label="anchor" href="#bigpca"></a>
</h1></div>
</div>
<div class="section level1">
<h1 id="principal-component-analysis-for-bigmemory-matrices">Principal component analysis for bigmemory matrices<a class="anchor" aria-label="anchor" href="#principal-component-analysis-for-bigmemory-matrices"></a>
</h1>
<div class="section level2">
<h2 id="frédéric-bertrand">Frédéric Bertrand<a class="anchor" aria-label="anchor" href="#fr%C3%A9d%C3%A9ric-bertrand"></a>
</h2>
<!-- badges: start -->

<p>The <strong>bigPCA</strong> package provides high performance principal component analysis (PCA) routines for <code><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">bigmemory::big.matrix</a></code> objects. The package streams data through BLAS and LAPACK kernels so that very large matrices can be analysed without first copying them into native R matrices. It also includes helpers to export PCA diagnostics such as scores, loadings, correlations, and contributions into file-backed <code>big.matrix</code> allocations suitable for downstream analysis pipelines.</p>
<p><code>bigPCA</code> exposes two complementary backends:</p>
<ul>
<li>
<strong>bigmemory</strong> – operates directly on in-memory or file-backed <code>big.matrix</code> objects using the bigmemory C++ API.</li>
<li>
<strong>bigalgebra</strong> – writes results into <code>bigalgebra</code> matrices so that large studies can keep intermediate artifacts out-of-memory while benefiting from native BLAS/LAPACK performance.</li>
</ul>
<p>These workflows make it possible to analyse data sets that exceed the available RAM while keeping numerical stability through double-precision accumulation and LAPACK eigen decompositions.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <strong>bigPCA</strong> from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"fbertran/bigPCA"</span><span class="op">)</span></span></code></pre></div>
<p>If you prefer a local source install, clone the repository and run:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>R CMD build bigPCA</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>R CMD INSTALL bigPCA_0.<span class="dv">0</span>.<span class="fl">1.</span>tar.gz</span></code></pre></div>
<p>For workflows that rely on the <code>bigalgebra</code> back-end, ensure that the package is installed:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"bigalgebra"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="options">Options<a class="anchor" aria-label="anchor" href="#options"></a>
</h2>
<p>The package defines several options to control numerical tolerances and workspace allocation. They are prefixed with <code>bigPCA.</code> and include:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr>
<th>Option</th>
<th>Default value</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td><code>bigPCA.block_size</code></td>
<td><code>1000L</code></td>
<td>Number of rows processed in each block when streaming scores through BLAS.</td>
</tr>
<tr>
<td><code>bigPCA.center_scale_epsilon</code></td>
<td><code>1e-8</code></td>
<td>Lower bound applied when rescaling columns to avoid division instabilities.</td>
</tr>
<tr>
<td><code>bigPCA.progress</code></td>
<td><code>FALSE</code></td>
<td>Emit progress updates when computing PCA on long-running jobs.</td>
</tr>
</tbody>
</table>
<p>All options can be changed with <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> at runtime. For example, <code>options(bigPCA.block_size = 5000L)</code> increases the streaming block size.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The examples below demonstrate the bigmemory workflow and compare the results with base R’s <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp()</a></code> implementation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaneplusplus/bigmemory" class="external-link">bigmemory</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/bigPCAcpp/">bigPCA</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Allocate a 1,000 x 25 big.matrix with simulated values</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, type <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="va">bm</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run PCA and extract eigenvalues and rotation</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pca_bigmatrix</span><span class="op">(</span><span class="va">bm</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">importance</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Generate PCA scores in bigmemory-backed storage</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">filebacked.big.matrix</a></span><span class="op">(</span><span class="va">n</span>, ncol <span class="op">=</span> <span class="fl">3</span>, type <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/pca_bigalgebra.html">pca_scores_bigalgebra</a></span><span class="op">(</span></span>
<span>  <span class="va">bm</span>,</span>
<span>  <span class="va">scores</span>,</span>
<span>  <span class="va">res</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  center <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">center</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">scale</span></span>
<span><span class="op">)</span></span>
<span><span class="va">scores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Compare with prcomp()</span></span>
<span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">bm</span><span class="op">[</span><span class="op">]</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="va">pr</span><span class="op">$</span><span class="va">rotation</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">res</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, tolerance <span class="op">=</span> <span class="fl">1e-6</span><span class="op">)</span></span></code></pre></div>
<p>To stream the diagnostics into <code>bigalgebra</code> matrices, use the corresponding helper functions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaneplusplus/bigmemory" class="external-link">bigmemory</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/bigalgebra/" class="external-link">bigalgebra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/bigPCAcpp/">bigPCA</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">filebacked.big.matrix</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, type <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span><span class="va">bm</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">pca_bigmatrix</span><span class="op">(</span><span class="va">bm</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rotation</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">loadings</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">correlations</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">contrib</span> <span class="op">&lt;-</span> <span class="fu">bigmemory</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigmemory/man/big.matrix.html" class="external-link">big.matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pca_rotation_bigalgebra</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">rotation</span>, <span class="va">rotation</span><span class="op">)</span></span>
<span><span class="fu">pca_loadings_bigalgebra</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">rotation</span>, <span class="va">res</span><span class="op">$</span><span class="va">importance</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span>, <span class="va">loadings</span><span class="op">)</span></span>
<span><span class="fu">pca_correlations_bigalgebra</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">rotation</span>, <span class="va">res</span><span class="op">$</span><span class="va">importance</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, <span class="va">correlations</span><span class="op">)</span></span>
<span><span class="fu">pca_contributions_bigalgebra</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">rotation</span>, <span class="va">contrib</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <strong>bigPCA</strong> in academic work, please cite:</p>
<p>Bertrand F. (2025). <em>bigPCA: Principal Component Analysis for bigmemory Matrices</em>.</p>
</div>
<div class="section level2">
<h2 id="maintainer">Maintainer<a class="anchor" aria-label="anchor" href="#maintainer"></a>
</h2>
<p>Maintainer: Frédéric Bertrand <a href="mailto:frederic.bertrand@lecnam.net" class="email">frederic.bertrand@lecnam.net</a></p>
<p>For questions, bug reports, or contributions, please open an issue on <a href="https://github.com/fbertran/bigPCA" class="external-link">GitHub</a>.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/fbertran/bigPCAcpp/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/fbertran/bigPCAcpp/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing bigPCA</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Frederic Bertrand <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/fbertran/bigPCAcpp/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/fbertran/bigPCAcpp/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Frederic Bertrand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
